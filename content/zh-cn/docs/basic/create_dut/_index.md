---
title: 创建DUT
description:  开放验证平台DUT创建的相关知识。
categories: [示例项目, 学习材料]
tags: [examples, docs]
weight: 3
---

{{% pageinfo %}}
本节主要介绍创建DUT的相关知识。
{{% /pageinfo %}}

创建DUT（Design Under Test）是指在芯片验证过程中，设计并实现被测对象的电路或系统。DUT是验证的主体，是需要验证的电路设计。在创建DUT时，通常需要考虑被测对象的功能、性能要求和验证目标，然后使用硬件描述语言（HDL）或通过图形化设计工具生成电路设计。创建DUT是验证过程中的第一步，其质量和准确性直接影响着后续的验证工作。

传统的硬件描述语言包括Verilog、System Verilog、VHDL等。同时，作为新兴的RTL设计语言，Chisel（[https://www.chisel-lang.org/](https://www.chisel-lang.org/)）也以其面向对象的特征和便捷性，逐渐在RTL设计中扮演越来越重要的角色。

以[加法器DUT的创建]("/zh-cn/docs/quick-start/")为例，进行解释。

## Chisel
准确来说，Chisel是基于Scala语言的高级硬件构造（HCL）语言。传统HDL是描述电路，而HCL则是生成电路，更加抽象和高级。同时Chisel中提供的Stage包则可以将HCL设计转化成Verilog、System Verilog等传统的HDL语言设计。配合上Mill、Sbt等Scala工具则可以实现自动化的开发。

以下为加法器的HCL代码：
```scala
// adder.scala
package adder

import chisel3._
import chisel3.util._

class Adder extends Module{
    val io = IO(new Bundle{
        val a = Input(UInt(8.W))
        val b = Input(UInt(8.W))
        val cin = Input(Bool())
        val sum = Output(UInt(8.W))
    })

    io.sum := io.a + io.b + io.cin.asUInt
}
```
代码生成入口：
```scala
// Elavorate.scala
object Elaborate extends App {
  val firtoolOptions = Array("--lowering-options=" + List(
    // make yosys happy
    // see https://github.com/llvm/circt/blob/main/docs/VerilogGeneration.md
    "disallowLocalVariables",
    "disallowPackedArrays",
    "locationInfoStyle=wrapInAtSquareBracket"
  ).reduce(_ + "," + _))
  circt.stage.ChiselStage.emitSystemVerilogFile(new adder.Adder, args, firtoolOptions)
}
```
使用mill工具得到的HDL代码：
```verilog
// Generated by CIRCT firtool-1.66.0
module Adder(	// @[src/main/adder.scala:6:7]
  input        clock,	// @[src/main/adder.scala:6:7]
               reset,	// @[src/main/adder.scala:6:7]
  input  [7:0] io_a,	// @[src/main/adder.scala:7:16]
               io_b,	// @[src/main/adder.scala:7:16]
  input        io_cin,	// @[src/main/adder.scala:7:16]
  output [7:0] io_sum	// @[src/main/adder.scala:7:16]
);

  assign io_sum = io_a + io_b + {7'h0, io_cin};	// @[src/main/adder.scala:6:7, :14:{20,27}]
endmodule
```
此外，如果使用mill工具，你可能还需要配置工程环境以及直到mill编译的脚本`build.sc`，具体可以参考[https://github.com/OSCPU/chisel-playground](https://github.com/OSCPU/chisel-playground)

## Verilog

下面是一个示例的加法器 Verilog 代码：

```verilog
module Adder #(
    parameter WIDTH = 64
) (
    input [WIDTH-1:0] a,
    input [WIDTH-1:0] b,
    input cin,
    output [WIDTH-1:0] sum,
    output cout
);

assign {cout, sum}  = a + b + cin;

endmodule
```
该部分定义了一个64位带进位的加法器。